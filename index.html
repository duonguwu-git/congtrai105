<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√≥i Qu·∫ª 10/5 - B·∫£n ·ªîn ƒê·ªãnh Nh·∫•t</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #fff5e6; color: #5d4037; 
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; text-align: center; padding: 20px; overflow: hidden;
        }
        .container {
            width: 100%; max-width: 420px; background: rgba(255, 245, 230, 0.98);
            border-radius: 20px; padding: 25px; box-shadow: 0 8px 30px rgba(0,0,0,0.15); z-index: 10;
        }
        h1 { color: #c0392b; font-size: 22px; margin-bottom: 10px; }
        button {
            background: #ffd700; color: #5d4037; border: none; padding: 15px;
            font-size: 17px; border-radius: 12px; cursor: pointer;
            margin: 8px 0; font-weight: bold; width: 100%; transition: 0.2s;
        }
        input[type="date"] { padding: 12px; font-size: 18px; border: 2px solid #c0392b; border-radius: 10px; width: 100%; margin: 15px 0; }
        
        .screen { display: none; opacity: 0; transition: 0.4s; }
        .active { display: block; opacity: 1; }

        /* B√¨nh Qu·∫ª & Mantra */
        #jar-wrapper { position: relative; width: 160px; margin: 15px auto; cursor: pointer; }
        #jar {
            width: 140px; height: 200px; background: linear-gradient(#8b4513, #d2691e);
            border: 6px solid #5d4037; border-radius: 15px 15px 45px 45px; margin: 0 auto;
        }
        .shaking { animation: shake 0.1s infinite; }
        @keyframes shake { 0% {transform: rotate(0);} 25% {transform: rotate(-10deg);} 75% {transform: rotate(10deg);} }
        
        .mantra { position: absolute; color: #c0392b; font-weight: bold; opacity: 0; pointer-events: none; }
        .shaking .mantra { animation: fly 1s infinite linear; opacity: 1; }
        @keyframes fly { 0% { transform: translateY(0) scale(0.5); opacity: 0; } 100% { transform: translateY(-100px) scale(1.2); opacity: 0; } }

        /* Th·∫ª qu·∫ª */
        .sticks-container { display: flex; justify-content: center; align-items: flex-end; height: 140px; margin: 15px 0; }
        .stick { width: 22px; height: 110px; background: #8b4513; margin: 0 5px; border-radius: 6px 6px 0 0; cursor: pointer; transition: 0.3s; }
        .stick.selected { transform: translateY(-60px); background: #ffd700; border: 2px solid #c0392b; }
        .stick.disabled { opacity: 0.3; pointer-events: none; }

        /* Modal */
        #result-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.92); display: none; justify-content: center; align-items: center; z-index: 99; padding: 20px;
        }
        #checkin-board { background: white; border: 4px solid #c0392b; border-radius: 15px; padding: 20px; width: 100%; max-width: 350px; }
        #timer-box { background: #ff4757; color: white; padding: 8px; border-radius: 5px; margin: 10px 0; font-size: 14px; font-weight: bold; display: none; }
    </style>
</head>
<body>

    <div class="container">
        <div id="screen1" class="screen active">
            <h1>üîÆ XIN QU·∫∫ L·ªöP 10/5 üîÆ</h1>
            <p>H√¥m nay b·∫°n mu·ªën xem ƒëi·ªÅu g√¨?</p>
            <button onclick="nav('screen2')">B·∫ÆT ƒê·∫¶U</button>
        </div>

        <div id="screen2" class="screen">
            <p>Vui l√≤ng nh·∫≠p ng√†y sinh:</p>
            <input type="date" id="bday">
            <button onclick="checkBday()">TI·∫æP T·ª§C</button>
        </div>

        <div id="screen-jar" class="screen">
            <div id="jar-wrapper" onclick="handleShake()">
                <div class="mantra" style="left: 0;">√öm ma ni...</div>
                <div class="mantra" style="right: 0;">B√°t di h·ªìng...</div>
                <div id="jar"></div>
            </div>
            <p>üî• <b>B·∫§M V√ÄO B√åNH ƒê·ªÇ L·∫ÆC</b> üî•</p>
        </div>

        <div id="screen-sticks" class="screen">
            <p>Ch·ªçn 1 qu·∫ª ƒë·ªÉ r√∫t:</p>
            <div class="sticks-container" id="sticks-box"></div>
        </div>
    </div>

    <div id="result-modal">
        <div id="checkin-board">
            <h2 style="color: #c0392b">üìú TH√ÅNH QU·∫∫ CH·ªà D·∫™N</h2>
            <div id="fortune-msg" style="margin: 15px 0; color: #5d4037;"></div>
            <div id="timer-box">‚è≥ L·ªòC C√ì H·∫†N: <span id="clock">15:00</span></div>
            <div id="gift-box" style="background: #fff5e6; padding: 12px; border-radius: 8px; border: 2px dashed #c0392b; font-weight: bold; color: #c0392b;">
                ƒêang ch·ªù nh·∫≠n l·ªôc...
            </div>
            <button id="gift-btn" onclick="revealGift()" style="background: #c0392b; color: white; margin-top: 15px;">üéÅ NH·∫¨N L·ªòC</button>
        </div>
    </div>

    <script>
        // --- √ÇM THANH "·∫¢O" ·ªîN ƒê·ªäNH NH·∫§T ---
        const AudioCtx = window.AudioContext || window.webkitAudioContext;
        let ctx;

        function playSound(type) {
            if (!ctx) ctx = new AudioCtx();
            if (ctx.state === 'suspended') ctx.resume();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain); gain.connect(ctx.destination);

            if (type === 'click') {
                osc.frequency.setValueAtTime(400, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
                osc.start(); osc.stop(ctx.currentTime + 0.1);
            } else if (type === 'shake') {
                osc.type = 'square'; osc.frequency.setValueAtTime(120, ctx.currentTime);
                gain.gain.setValueAtTime(0.05, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.08);
                osc.start(); osc.stop(ctx.currentTime + 0.08);
            } else if (type === 'swipe') {
                osc.type = 'triangle'; osc.frequency.setValueAtTime(800, ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(100, ctx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.1, ctx.currentTime);
                osc.start(); osc.stop(ctx.currentTime + 0.2);
            } else if (type === 'win') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(500, ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1000, ctx.currentTime + 0.4);
                gain.gain.setValueAtTime(0.1, ctx.currentTime);
                osc.start(); osc.stop(ctx.currentTime + 0.4);
            }
        }

        function nav(id) {
            playSound('click');
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            setTimeout(() => {
                document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
                document.getElementById(id).style.display = 'block';
                setTimeout(() => document.getElementById(id).classList.add('active'), 50);
            }, 300);
        }

        function checkBday() {
            if(!document.getElementById('bday').value) return alert("Nh·∫≠p ng√†y sinh nh√©!");
            nav('screen-jar');
        }

        let shakeInt;
        function handleShake() {
            const jar = document.getElementById('jar-wrapper');
            if(jar.classList.contains('shaking')) return;
            jar.classList.add('shaking');
            shakeInt = setInterval(() => playSound('shake'), 120);
            setTimeout(() => {
                clearInterval(shakeInt);
                jar.classList.remove('shaking');
                nav('screen-sticks');
                renderSticks();
            }, 2500);
        }

        function renderSticks() {
            const box = document.getElementById('sticks-box');
            box.innerHTML = '';
            for(let i=0; i<5; i++) {
                const s = document.createElement('div');
                s.className = 'stick';
                s.onclick = function() {
                    playSound('swipe');
                    this.classList.add('selected');
                    document.querySelectorAll('.stick').forEach(el => { if(el!==this) el.classList.add('disabled')});
                    setTimeout(showResult, 800);
                };
                box.appendChild(s);
            }
        }

        function showResult() {
            const fots = ["T√†i l·ªôc r·∫°ng r·ª°, g·∫∑p d·ªØ h√≥a l√†nh.", "Qu√Ω nh√¢n ph√π tr·ª£, gh√© 10/5 l√† h√™n.", "V·∫°n s·ª± nh∆∞ √Ω, c√¥ng vi·ªác hanh th√¥ng."];
            document.getElementById('fortune-msg').innerText = fots[Math.floor(Math.random()*fots.length)];
            document.getElementById('result-modal').style.display = 'flex';
        }

        function revealGift() {
            playSound('win');
            const gifts = [
                "L·ªòC K·∫æT ƒêO√ÄN: Nh√≥m 5 b·∫°n mua chung -> Gi·∫£m ngay 10.000ƒë!",
                "L·ªòC TRI K·ª∂: Mua 3 ly -> T·∫∑ng th√™m Topping cho c·∫£ 3 ly!",
                "L·ªòC MAY M·∫ÆN: Gi·∫£m ngay 2.000ƒë khi mua t·ª´ 2 ly!",
                "L·ªòC ƒê·∫†I C√ÅT: T·∫∑ng 1 sticker/ph·∫ßn qu√† nh·ªè khi mua n∆∞·ªõc!"
            ];
            document.getElementById('gift-box').innerText = "üéÅ " + gifts[Math.floor(Math.random()*gifts.length)];
            document.getElementById('gift-btn').style.display = 'none';
            document.getElementById('timer-box').style.display = 'block';
            startTimer();
        }

        function startTimer() {
            let t = 900;
            const clock = document.getElementById('clock');
            const cd = setInterval(() => {
                let m = Math.floor(t / 60), s = t % 60;
                clock.innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
                if (t-- <= 0) clearInterval(cd);
            }, 1000);
        }
    </script>
</body>
</html>
